# TechForum 项目未来发展路线图

> **文档目标**：为项目提供清晰的技术演进路径和功能扩展方向，确保项目在简历中具有足够的技术深度和亮点。

---

## 📋 目录

1. [技术架构演进路线](#技术架构演进路线)
2. [功能模块扩展计划](#功能模块扩展计划)
3. [性能优化方向](#性能优化方向)
4. [可扩展性设计](#可扩展性设计)
5. [面试加分项落地](#面试加分项落地)

---

## 🏗️ 技术架构演进路线

### 当前架构 (v1.0)
```
Frontend: Vue 3 + Pinia + Element Plus
   ↓ HTTP/REST
Backend: Spring Boot 3 + MyBatis + JWT
   ↓
Database: MySQL 8.0
Storage: 本地文件系统
```

### 目标架构 (v2.0 - 推荐实现)
```
Frontend: Vue 3 + Pinia + Element Plus + TypeScript
   ↓ HTTP/REST + WebSocket
Backend: Spring Boot 3 + MyBatis + Redis + MinIO
   ↓
Cache: Redis (热点数据、会话、限流)
Database: MySQL 8.0 (主库) + 读写分离预留
Storage: MinIO (分布式对象存储)
Monitor: Spring Boot Actuator + Prometheus
```

### 进阶架构 (v3.0 - 可选，面试谈论即可)
```
Frontend: Vue 3 + TypeScript + Vite + SSR (Nuxt.js可选)
   ↓ 
API Gateway: Spring Cloud Gateway (统一入口、限流、鉴权)
   ↓
Microservices:
  - User Service (用户认证授权)
  - Post Service (帖子管理)
  - Interaction Service (点赞收藏评论)
  - Notification Service (通知推送)
   ↓
Message Queue: RabbitMQ/Kafka (异步解耦)
Cache: Redis Cluster (分布式缓存)
Database: MySQL (分库分表) + ElasticSearch (全文搜索)
Storage: MinIO Cluster (高可用对象存储)
Monitor: ELK Stack (日志) + Prometheus + Grafana (监控)
```

---

## 📦 功能模块扩展计划

### 第一优先级：核心互动功能 (1-2周)

#### 1. Redis缓存系统 ⭐⭐⭐
**实现价值**：提升系统性能，减少数据库压力，面试高频考点

```java
// 推荐缓存策略
1. 用户Session缓存 (String)
   Key: "user:session:{token}" 
   Value: UserInfo JSON
   TTL: 1小时

2. 热门帖子缓存 (Hash)
   Key: "post:hot:list"
   Field: postId
   Value: Post JSON
   TTL: 5分钟

3. 点赞数缓存 (String + 定时同步)
   Key: "post:likes:{postId}"
   Value: count
   异步刷回MySQL

4. 验证码缓存 (String)
   Key: "captcha:{email}"
   Value: code
   TTL: 5分钟
```

**面试亮点**：
- Redis五种数据类型实战应用
- 缓存穿透、击穿、雪崩的解决方案
- 缓存与数据库一致性保证（双写、延迟双删）

#### 2. MinIO对象存储 ⭐⭐⭐
**实现价值**：分布式存储，支持海量图片/视频，贴近生产环境

```java
// 存储结构设计
Bucket: tech-forum
  - avatars/       用户头像
  - posts/         帖子图片
  - videos/        视频文件
  - attachments/   附件下载

// 安全策略
1. 文件类型白名单验证
2. 文件大小限制（图片5MB，视频50MB）
3. 文件名MD5重命名防冲突
4. Public Read策略 + CDN加速
```

**面试亮点**：
- 分布式存储架构理解
- 文件上传安全防护
- 大文件分片上传（可选）

#### 3. 点赞/收藏/关注功能 ⭐⭐⭐
**实现价值**：用户互动核心，涉及高并发写入，缓存策略设计

```java
// 技术方案
1. 点赞：Redis Set + 异步MySQL持久化
   - SADD post:likes:{postId} {userId}
   - 定时任务/消息队列刷回数据库
   
2. 收藏：直接写MySQL + Redis缓存收藏列表

3. 关注：MySQL存储 + Redis ZSet实现关注Feed流
   - ZADD user:feed:{userId} {timestamp} {postId}
```

**面试亮点**：
- 高并发写入优化（异步落库）
- Redis与MySQL数据一致性
- Feed流设计（推拉模式）

---

### 第二优先级：用户体验增强 (2-3周)

#### 4. 实时通知系统 ⭐⭐⭐
**实现价值**：提升用户体验，展示WebSocket实时通信能力

```java
// 技术方案
1. WebSocket连接管理
   - Spring WebSocket + STOMP协议
   - 用户上线维护在线列表

2. 通知类型
   - 点赞通知
   - 评论通知
   - @提醒通知
   - 系统公告

3. 存储设计
   - MySQL存储通知记录
   - Redis缓存未读数量
```

**面试亮点**：
- WebSocket双向通信原理
- STOMP协议理解
- 长连接管理与心跳机制

#### 5. 搜索功能 ⭐⭐
**基础版**：MySQL LIKE + 全文索引
```sql
SELECT * FROM posts 
WHERE MATCH(title, content) AGAINST('关键词' IN NATURAL LANGUAGE MODE);
```

**进阶版**：ElasticSearch全文搜索（可选，面试加分）
```java
// ES集成要点
1. Spring Data Elasticsearch
2. 数据同步策略（Canal/Logstash）
3. 搜索结果高亮
4. 搜索历史/热词统计
```

**面试亮点**：
- MySQL全文索引优缺点
- ES倒排索引原理
- 搜索相关性评分

#### 6. 邮箱验证与找回密码 ⭐⭐
```java
// 实现要点
1. Spring Boot Mail集成
2. 验证码生成与Redis存储
3. 防刷机制（IP限流、图形验证码）
4. 邮件模板美化
```

---

### 第三优先级：运营与管理 (1-2周)

#### 7. 管理员后台 ⭐⭐
```java
// 功能清单
1. 用户管理（封禁、禁言、权限设置）
2. 内容审核（帖子审核、举报处理）
3. 数据统计（用户增长、活跃度、热门内容）
4. 系统配置（分区管理、敏感词过滤）

// 技术要点
- Spring Security角色权限控制 (ROLE_ADMIN)
- @PreAuthorize注解鉴权
- 操作日志记录（AOP切面）
```

#### 8. 内容安全 ⭐
```java
// 敏感词过滤
1. DFA算法实现高效过滤
2. 敏感词库动态更新
3. 人工审核工作流

// 防刷机制
1. 接口限流（Redis + 注解）
2. 验证码（注册、登录、发帖）
3. 行为检测（短时间大量操作）
```

---

## ⚡ 性能优化方向

### 数据库优化 ⭐⭐⭐

#### 1. 索引优化
```sql
-- 当前索引现状分析
EXPLAIN SELECT * FROM posts WHERE user_id = ? ORDER BY create_time DESC;

-- 推荐索引
CREATE INDEX idx_user_create ON posts(user_id, create_time DESC);
CREATE INDEX idx_category_hot ON posts(category_id, view_count DESC);
CREATE INDEX idx_user_username ON users(username); -- 登录查询
```

#### 2. 慢查询优化
```sql
-- 开启慢查询日志
SET GLOBAL slow_query_log = 'ON';
SET GLOBAL long_query_time = 2;

-- 分析慢查询
SELECT * FROM mysql.slow_log ORDER BY query_time DESC LIMIT 10;
```

#### 3. 分页优化
**问题**：深分页性能差
```sql
-- 传统分页（慢）
SELECT * FROM posts ORDER BY id DESC LIMIT 100000, 20;

-- 游标分页（快）
SELECT * FROM posts WHERE id < ? ORDER BY id DESC LIMIT 20;
```

**面试亮点**：
- 深分页问题原因（回表查询）
- 游标分页原理
- 覆盖索引优化

---

### 缓存优化 ⭐⭐⭐

#### 1. 缓存设计模式
```java
// Cache-Aside Pattern（推荐）
public Post getPost(Long id) {
    // 1. 查Redis
    Post post = redisTemplate.opsForValue().get("post:" + id);
    if (post != null) return post;
    
    // 2. 查MySQL
    post = postMapper.selectById(id);
    if (post != null) {
        // 3. 写Redis
        redisTemplate.opsForValue().set("post:" + id, post, 10, TimeUnit.MINUTES);
    }
    return post;
}
```

#### 2. 缓存问题应对
```java
// 缓存穿透：布隆过滤器
@Bean
public BloomFilter<Long> postBloomFilter() {
    BloomFilter<Long> filter = BloomFilter.create(Funnels.longFunnel(), 100000, 0.01);
    // 加载所有postId
    return filter;
}

// 缓存击穿：互斥锁
public Post getPost(Long id) {
    String lockKey = "lock:post:" + id;
    if (redisTemplate.opsForValue().setIfAbsent(lockKey, "1", 10, TimeUnit.SECONDS)) {
        try {
            // 加载数据
        } finally {
            redisTemplate.delete(lockKey);
        }
    }
}

// 缓存雪崩：随机过期时间
int expireTime = 600 + new Random().nextInt(300); // 10-15分钟随机
```

**面试亮点**：
- 缓存三大问题深度理解
- 布隆过滤器原理
- 分布式锁实现

---

### 接口优化 ⭐⭐

#### 1. 接口限流
```java
// 基于Redis的滑动窗口限流
@Aspect
@Component
public class RateLimitAspect {
    @Around("@annotation(rateLimit)")
    public Object around(ProceedingJoinPoint pjp, RateLimit rateLimit) {
        String key = "rate:limit:" + request.getRemoteAddr();
        Long count = redisTemplate.opsForValue().increment(key);
        if (count == 1) {
            redisTemplate.expire(key, rateLimit.time(), TimeUnit.SECONDS);
        }
        if (count > rateLimit.count()) {
            throw new BizException("请求过于频繁");
        }
        return pjp.proceed();
    }
}
```

#### 2. 异步处理
```java
// Spring @Async异步发送通知
@Async
public void sendNotification(Long userId, String message) {
    // 异步处理，不阻塞主流程
}

// 配置线程池
@EnableAsync
@Configuration
public class AsyncConfig implements AsyncConfigurer {
    @Override
    public Executor getAsyncExecutor() {
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setCorePoolSize(5);
        executor.setMaxPoolSize(10);
        executor.setQueueCapacity(100);
        executor.setThreadNamePrefix("async-");
        executor.initialize();
        return executor;
    }
}
```

---

## 🔧 可扩展性设计

### 架构层面

#### 1. 配置外部化
```yaml
# application-dev.yml / application-prod.yml
spring:
  datasource:
    url: ${DB_URL:jdbc:mysql://localhost:3306/tech_forum}
    username: ${DB_USERNAME:root}
    password: ${DB_PASSWORD}
  
  redis:
    host: ${REDIS_HOST:localhost}
    password: ${REDIS_PASSWORD:}

minio:
  endpoint: ${MINIO_ENDPOINT:http://localhost:9000}
  accessKey: ${MINIO_ACCESS_KEY}
  secretKey: ${MINIO_SECRET_KEY}
```

#### 2. Docker容器化
```dockerfile
# Dockerfile
FROM openjdk:17-jdk-slim
COPY target/tech-forum.jar app.jar
EXPOSE 8080
ENTRYPOINT ["java", "-jar", "/app.jar"]
```

```yaml
# docker-compose.yml
version: '3.8'
services:
  mysql:
    image: mysql:8.0
    environment:
      MYSQL_DATABASE: tech_forum
      MYSQL_ROOT_PASSWORD: ${MYSQL_PASSWORD}
    ports:
      - "3306:3306"
    volumes:
      - mysql-data:/var/lib/mysql

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    command: redis-server --requirepass ${REDIS_PASSWORD}

  minio:
    image: minio/minio:latest
    ports:
      - "9000:9000"
      - "9001:9001"
    environment:
      MINIO_ROOT_USER: ${MINIO_ACCESS_KEY}
      MINIO_ROOT_PASSWORD: ${MINIO_SECRET_KEY}
    command: server /data --console-address ":9001"
    volumes:
      - minio-data:/data

  app:
    build: .
    ports:
      - "8080:8080"
    depends_on:
      - mysql
      - redis
      - minio
    environment:
      DB_URL: jdbc:mysql://mysql:3306/tech_forum
      REDIS_HOST: redis
      MINIO_ENDPOINT: http://minio:9000
```

#### 3. 监控与日志
```java
// Spring Boot Actuator
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-actuator</artifactId>
</dependency>

// Prometheus监控暴露
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  metrics:
    export:
      prometheus:
        enabled: true
```

---

## 🎯 面试加分项落地

### 高频考点对应功能

| 面试考点 | 对应功能实现 | 难度 | 优先级 |
|---------|-------------|------|--------|
| JWT认证原理 | ✅ 已实现 | ⭐⭐ | 已完成 |
| Spring Security过滤器链 | ✅ 已实现 | ⭐⭐⭐ | 已完成 |
| Redis缓存策略 | 🔨 待实现 | ⭐⭐⭐ | 高 |
| 缓存一致性问题 | 🔨 Redis+MySQL双写 | ⭐⭐⭐ | 高 |
| 高并发点赞 | 🔨 Redis+异步落库 | ⭐⭐⭐ | 高 |
| 分页优化 | 🔨 游标分页 | ⭐⭐ | 中 |
| 接口限流 | 🔨 Redis滑动窗口 | ⭐⭐ | 中 |
| 文件上传安全 | 🔨 MinIO+校验 | ⭐⭐ | 中 |
| WebSocket通信 | 🔨 实时通知 | ⭐⭐ | 低 |
| 消息队列 | 💡 可选（面试谈）| ⭐⭐⭐ | 低 |
| 微服务拆分 | 💡 可选（面试谈）| ⭐⭐⭐ | 低 |

### 推荐实现优先级

**第一阶段（1-2周）- 必须完成**：
1. Redis缓存系统（用户信息、热门帖子、验证码）
2. MinIO对象存储（头像、帖子图片）
3. 点赞收藏关注功能

**第二阶段（2-3周）- 强烈推荐**：
4. 接口限流（注解+Redis）
5. 邮箱验证码（注册、找回密码）
6. 游标分页优化
7. 搜索功能（MySQL全文索引）

**第三阶段（1-2周）- 可选增强**：
8. WebSocket实时通知
9. 管理员后台
10. 敏感词过滤
11. Docker容器化部署

---

## 📊 技术选型建议

### 必须掌握（简历已写）
- ✅ Spring Boot 3 + Spring Security
- ✅ MyBatis + MySQL
- ✅ Redis（核心缓存）
- ✅ MinIO（对象存储）
- ✅ Vue 3 + Pinia

### 可选加分项（面试谈论即可）
- 💡 RabbitMQ/Kafka（消息队列）
- 💡 ElasticSearch（全文搜索）
- 💡 Spring Cloud（微服务）
- 💡 Docker + K8s（容器编排）
- 💡 Nginx（反向代理、负载均衡）

### 不推荐（过度设计）
- ❌ Dubbo/Nacos（单体应用无需RPC）
- ❌ Seata（分布式事务复杂度高）
- ❌ XXL-Job（定时任务用@Scheduled即可）

---

## 🎓 学习路径建议

### Week 1-2：Redis实战
```
Day 1-2：Redis基础
  - 五种数据类型（String, List, Set, ZSet, Hash）
  - 常用命令实操
  
Day 3-4：缓存应用
  - 实现用户Session缓存
  - 实现热门帖子缓存
  - 验证码存储
  
Day 5-7：高级特性
  - 缓存穿透/击穿/雪崩解决方案
  - Redis事务与Lua脚本
  - 持久化机制（RDB vs AOF）
```

### Week 3-4：MinIO + 互动功能
```
Day 1-3：MinIO集成
  - Docker搭建MinIO
  - Spring Boot集成
  - 文件上传安全校验
  
Day 4-7：点赞收藏
  - Redis Set存储点赞关系
  - 异步落库策略
  - 收藏夹功能
  - 关注Feed流设计
```

### Week 5-6：性能优化
```
Day 1-2：数据库优化
  - 索引分析与优化
  - 慢查询定位
  - 游标分页实现
  
Day 3-5：接口优化
  - 限流注解实现
  - @Async异步处理
  - 批量查询优化
  
Day 6-7：监控与日志
  - Spring Boot Actuator
  - Logback日志配置
  - 接口性能统计
```

---

## 💡 面试应答模板

### 问：你的项目有哪些技术亮点？

**回答**：
1. **JWT无状态认证**：结合Spring Security自定义过滤器链，实现了无状态认证体系，支持水平扩展。
   
2. **Redis缓存策略**：采用Cache-Aside模式，对热点数据如用户信息、帖子详情进行缓存，并通过布隆过滤器解决缓存穿透问题。
   
3. **高并发点赞优化**：使用Redis Set存储点赞关系，配合异步任务定时刷回MySQL，大幅降低数据库写入压力。
   
4. **游标分页优化**：针对深分页性能问题，采用基于主键的游标分页，避免OFFSET大量回表查询。
   
5. **MinIO分布式存储**：使用MinIO实现对象存储，支持海量图片/视频存储，配合CDN加速提升访问速度。

### 问：如何保证Redis和MySQL数据一致性？

**回答**：
我采用了**延迟双删**策略：
1. 更新时：先删除缓存 → 更新数据库 → 延迟500ms再删除缓存
2. 查询时：使用Cache-Aside模式，缓存未命中时查库并回写缓存
3. 对于点赞这种高并发场景，采用**异步落库** + **定时全量同步**保证最终一致性

此外，对于关键数据，我会设置较短的缓存过期时间（如5分钟），即使出现不一致，也能快速自动修复。

### 问：如何应对缓存穿透、击穿、雪崩？

**回答**：
**缓存穿透**（查询不存在的数据）：
- 使用布隆过滤器，在查询前先判断数据是否存在
- 对空结果也缓存，但设置较短过期时间（如1分钟）

**缓存击穿**（热点数据过期）：
- 使用互斥锁（Redis SETNX），只允许一个线程加载数据
- 热点数据设置逻辑过期而非真实过期

**缓存雪崩**（大量缓存同时过期）：
- 过期时间添加随机值（如10-15分钟随机）
- 使用Redis集群提高可用性
- 服务降级，返回默认数据

---

## 📅 总结与行动计划

### 近期目标（1-2周）
- [ ] 完成Redis缓存系统集成
- [ ] 实现MinIO对象存储
- [ ] 完成点赞收藏功能
- [ ] 编写单元测试

### 中期目标（3-4周）
- [ ] 接口限流实现
- [ ] 邮箱验证功能
- [ ] 搜索功能优化
- [ ] 管理后台开发

### 长期目标（5-6周）
- [ ] Docker容器化部署
- [ ] 性能压测与优化
- [ ] 编写技术博客（至少5篇）
- [ ] 完善项目文档

### 面试准备
- [ ] 梳理项目技术架构图
- [ ] 准备STAR法则项目描述
- [ ] 整理高频面试题答案
- [ ] 录制项目演示视频

---

**最后更新**：2025-01-17  
**版本**：v1.0  
**作者**：TechForum Team
