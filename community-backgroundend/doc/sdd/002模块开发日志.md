// 2025.09.12 22:33
PostMapper的updateById用的Mybatis语句，标签语言，<if>语句中用test防止条件为空，
```js
@Update("""
        <script>
            UPDATE posts 
                <set>
                     <if title="title != null and title != ''"> // 此处不应该是title=""，而是test=""。不然为空就使
                       title = #{title},
                     </if>
                     <if content="content != null and content != ''"> 
                       content = #{content},
                     </if>
                </set>
            WHERE id = #{id}
        </script>
    """)
```
这说是 OGNL 表达式，不知道，待学习
学习结果：


正在测试post的update功能
1.别账号修改不属于的帖子    --> my  (401 UnAuthorized)  --> 409(NotPostAuthor) --> ok
2.修改不存在的帖子          --> 需要转404不存在资源，现在是400输入不合法 --> 已创404，ok
3.正常修改                 --> OK
4.修改时只修改标题或内容    --> OK
5.修改内容为空             --> 400输入不合法


测试post的getAll排序
1.修改的越新越前 --> my (√)

测试post的分页
1.页数为0    --> 在Controll层修正为1，ok
2.页数为负数    --> 在Controll层修正为1，ok
3.页数加size直接超过已有数量    --> 直接返回空，ok


  #### 需要修改的 blocker 问题:


   1. 分页参数校验位置错误:     --> 在Controller层校验，传给Service层的参数已经是合法的 --> √
   2. 更新帖子的API设计不符合RESTful规范: 其实符合，就用回patch方案吧     --> √
   3. 缺少删除功能:       --> 已完成，待测试  -->已测试，ok
   4. Controller层过“重”:
   5. MyBatis动态SQL:
   6. 分页实现方式:
  请你根据我上面提出的“需要修改的blocker问题”，重新调整你的代码。特别是分页校验的位置和更新API的设计。

2025.09.15  9:51
  1.新加jwt过期处理：jwt在过滤器，过滤器先于spring执行，所以用不了GloabExceptionHandle
  2.新增规则，允许获取帖子"/api/posts"的get请求无需jwt验证

  10:54
  1.提取构造Response返回status的方法为ResponseUtil的sendErrorResponse方法
  2.在jwt之后的SecurityConfig中用上述方法处理"未认证"的情况和"已认证但无权限"的情况
  测试：get请求不携带auth应返回401，已认证但无权限不知道怎么测试 --> 返回403的都是，已测试
  
  11:38
  1.修复了创造帖子没返回创建完成后的帖子的问题
  2.验证了jwtToken过期时间是在创建时决定的

  23:14
  1.为了完善修改帖子的404，新增了一个异常类NotFoundException，专门处理资源不存在的情况
  2.完成了删除帖子功能，知道了Controll如何返回空响应体，删除通常不传入帖子内容，只有postId去数据库跟现登录用户比对
  3.待测试删除功能  --> ok

2025.09.16  9:34
  1.测试删除功能：
    1.成功删除 ->204 ok
    2.删除不存在的帖子 -> 404 ok
    3.删除不属于自己的帖子 -> 409 ok
    4.未登录删除 -> 401 ok
    666.postman会不更新要删除的id的，需要重启postman，不是idea的问题  --> ok

  2.发现创造帖子时从Secuirty中获取userId覆盖post的操作在Controller层做了，应该是Service负责的才对
    1.已改正，ok

  3.Gemini给了测试代码，明天看，晕
  接着开发


